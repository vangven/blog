---
title: VB6-文件打印小工具
image: /img/buildblog.jpg
description: >
    VB6-文件打印小工具。
---

**Notes：**
虽然说VB是一个古老的语言，有的人觉得早都应该淘汰了。  
但是个人觉得偶尔用来做一些便于工作的小工具还是很方便的。

## 懒人目录
{:.no_toc}
0. this unordered seed list will be replaced by toc as unordered list
{:toc}

## 小工具的小目标
为了便于制作好的模板生成打印文件稿纸和一些信息的审查表。  
## 窗体结构

~~~
├──文件打印系统V1.0
│  ├──Login.frm				//用于登陆使用
│  ├──简报.frm				//用于填写简报的相关信息
│  ├──简报示例.frm			//用于显示填写示范
│  ├──文件.frm				//用于填写文件稿纸的相关信息
│  ├──文件示例.frm			//用于显示填写示范
│  ├──文件预览.frm			//用于打印前放入文件稿纸的提示
│  ├──about.frm				//软件关于信息
│  ├──信息.frm				//关于文件号的提示信息
│  ├──资源管理器的相关文档
│     ├── 102				//文件稿纸的模板excel文件
└     └── 103				//简报的模板excel文件
~~~


## Login.frm
~~~vb
# file: 代码

Option Explicit
Public LoginSucceeded As Boolean

Private Sub Command1_Click()
  '检查正确的密码
    If txtPassword = "1" Then
        '将代码放在这里传递
        '成功到 calling 函数
        '设置全局变量时最容易的
        LoginSucceeded = True
        Unload Me
        简报.Show
    Else
        MsgBox "无效的授权码，请重试!", , "授权失败"
        txtPassword.SetFocus

    End If
End Sub

Private Sub Command4_Click()
  '检查正确的密码
    If txtPassword = "1" Then
        '将代码放在这里传递
        '成功到 calling 函数
        '设置全局变量时最容易的
        LoginSucceeded = True
        Unload Me
        文件.Show
    Else
        MsgBox "无效的授权码，请重试!", , "授权失败"
        txtPassword.SetFocus

    End If

End Sub

Private Sub Command5_Click()
    '设置全局变量为 false
    '不提示失败的登录
    LoginSucceeded = False
    Me.Hide
End Sub

Private Sub Form_Load()

End Sub

~~~

## 简报.frm
~~~vb
# file: 代码

Dim xlApp As Excel.Application
Dim xlBook As Excel.Workbook
Dim xlSheet As Excel.Worksheet

Private Sub Command1_Click()
Unload Me
Login.Show
End Sub

Private Sub Command2_Click()
Set xlApp = CreateObject("excel.application")
    xlApp.Visible = False
    Set xlBook = xlApp.Workbooks.Open(App.Path & "\简报.xls")
    With xlApp.ActiveSheet
        .Range("d2") = DTPicker2.Value
        .Range("b9") = DTPicker2.Value
        .Range("b4") = Text2.Text
        .Range("b10") = Text2.Text
    End With

    'xlApp.ActiveSheet.PrintPreview
    xlApp.ActiveSheet.PrintOut
    xlApp.DisplayAlerts = False
    xlBook.Close True
       ' xlBook.Save
   'xlBook.Close savechanges = False
   
    xlApp.Quit
    'xlApp.DisplayAlerts = False
    Set xlApp = Nothing
    Set xlBook = Nothing
    Set xlSheet = Nothing
End Sub

Private Sub Command3_Click()
Text2.Text = ""
End Sub

Private Sub 关于_Click()
about.Show
End Sub

Private Sub 示例_Click()
简报示例.Show
Me.Left = 简报示例.Width
End Sub

~~~

## 文件.frm
~~~vb
# file: 代码

Private Sub Command1_Click()
Unload Me
Login.Show
End Sub

Private Sub Command2_Click()
文件预览.Show
End Sub

Private Sub Command3_Click()
Combo5.Text = Year(Date)
Combo6.Text = Month(Date)
Combo7.Text = Day(Date)
End Sub

Private Sub Command4_Click()
Text1.Text = ""
Text2.Text = ""
Text3.Text = ""
Text4.Text = ""
End Sub

Private Sub Label2_Click()
信息.Show
End Sub

Private Sub 关于_Click()
about.Show
End Sub

Private Sub 示例_Click()
文件示例.Show
Me.Left = 文件示例.Width
End Sub

~~~

## 文件预览.frm
~~~vb
# file: 代码

Dim xlApp As Excel.Application
Dim xlBook As Excel.Workbook
Dim xlSheet As Excel.Worksheet

Private Sub Command2_Click()
    Unload Me
    Set xlApp = CreateObject("excel.application")
    xlApp.Visible = False
    Set xlBook = xlApp.Workbooks.Open(App.Path & "\文件.xls")
    With xlApp.ActiveSheet
        .Range("ae7") = 文件.Combo1.Text
        .Range("ah7") = 文件.Combo2.Text
        .Range("ab14") = 文件.Combo3.Text
        .Range("aa18") = 文件.Combo4.Text
        .Range("aa22") = 文件.Combo5.Text
        .Range("ad22") = 文件.Combo6.Text
        .Range("ag22") = 文件.Combo7.Text
        .Range("f26") = 文件.Text2.Text
        .Range("z28") = 文件.Text3.Text
        .Range("e40") = 文件.Text4.Text
        .Range("ae51") = 文件.Text1.Text
    End With
    
    'xlApp.ActiveSheet.PrintPreview
    xlApp.ActiveSheet.PrintOut
    xlApp.DisplayAlerts = False
    xlBook.Close True
    'xlBook.Close savechanges = False
       
    xlApp.Quit
    'xlApp.DisplayAlerts = False
    Set xlApp = Nothing
    Set xlBook = Nothing
    Set xlSheet = Nothing   
End Sub

~~~

## 信息.frm
~~~vb
# file: 代码

Private Sub Command1_Click()
Unload Me
文件.Show
End Sub

~~~

